<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title> üè¥‚Äç‚ò†Ô∏èAhoy ye devilüè¥‚Äç‚ò†Ô∏è, yer Invited t' me Birthday Party!</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fff7f0;
      --card:#ffffff;
      --accent:#ff7aa2;
      --muted:#6b6b6b;
      --glass: rgba(255,255,255,0.6);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{
      background: linear-gradient(180deg,var(--bg),#fff);
      display:flex;align-items:center;justify-content:center;padding:24px;
    }
    .scene{
      max-width:960px;width:100%;display:grid;grid-template-columns:1fr;gap:24px;align-items:center;
    }
    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:28px;box-shadow:0 10px 30px rgba(0,0,0,0.08);
      display:flex;gap:20px;flex-direction:column;align-items:center;text-align:center;
    }
    header h1{margin:0;font-size:28px}
    header p{margin:6px 0 0;color:var(--muted)}

    .hero{
      width:100%;display:flex;gap:18px;align-items:center;justify-content:center;flex-direction:column
    }
    .date-bubble{background:linear-gradient(135deg,#ffd1dc,#ffefe8);padding:12px 18px;border-radius:999px;font-weight:600}

    form{width:100%;max-width:620px;display:grid;gap:12px;align-items:start}
    .row{display:flex;gap:12px}
    input[type=text], input[type=email], input[type=number], textarea, select{
      width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.08);font-size:14px
    }
    textarea{min-height:90px;resize:vertical}
    .controls{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
    button{background:var(--accent);color:white;border:0;padding:10px 16px;border-radius:10px;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;color:var(--muted);border:1px solid rgba(0,0,0,0.06)}
    .meta{font-size:13px;color:var(--muted)}
    .rsvp-list{max-height:180px;overflow:auto;padding:8px;border-radius:10px;background:linear-gradient(180deg,#fff,#fff0);border:1px dashed rgba(0,0,0,0.03)}

    .footer{display:flex;gap:12px;justify-content:center;align-items:center}

    .popup{
      position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);
      display:flex;align-items:center;justify-content:center;z-index:9999;flex-direction:column;
    }
    .popup img{max-width:90%;max-height:80%;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
    .popup button{margin-top:20px;background:white;color:black;padding:10px 20px;border-radius:10px;border:none;cursor:pointer;font-weight:600}

    @media(min-width:880px){
      .scene{grid-template-columns:1fr 420px}
      .card{align-items:flex-start;text-align:left}
      .hero{align-items:flex-start}
    }
  </style>
</head>
<body>
  <!-- Background music -->
  <audio id="partyMusic" loop>
    <source src="Drunken-Sailor.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <!-- Image popup on load -->
  <div class="popup" id="imagePopup">
    <img src="pirate-me.jpg" alt="Birthday Surprise" />
    <button id="closePopup">Enter digital vessel</button>
  </div>

  <main class="scene">
    <section class="card">
      <header>
        <h1>üè¥‚Äç‚ò†Ô∏è Yer invited t' me birthday partyüè¥‚Äç‚ò†Ô∏è </h1>
        <p class="meta">Bring yer own rum (Grog not provided)</p>
      </header>

      <div class="hero">
        <div class="date-bubble">Saturday, September 27, 2025 ¬∑ 7:00 PM</div>
        <p class="meta">My vessel ‚Äî 102 Tennyson road (NW6 7SB)</p>
        <p class="meta">Expect to bring many a drink and find many a fellow pirate</p>
      </div>

      <p class="meta">Deploy yer RSVP below (or don't)</p>

      <form id="rsvpForm">
        <div class="row">
          <input id="name" type="text" placeholder="Yer name" required />
          <input id="email" type="email" placeholder="Yer email (optional)" />
        </div>

        <div class="row">
          <label style="display:flex;align-items:center;gap:8px"><input type="radio" name="attend" value="yes" checked /> I will set sale</label>
          <label style="display:flex;align-items:center;gap:8px"><input type="radio" name="attend" value="no" /> I can't make it (I'm a landlubber)</label>
        </div>

        <textarea id="message" placeholder="Message or note fer the cap'n (e.g. song request)"></textarea>

        <div class="controls">
          <button type="submit">Deploy RSVP</button>
          <button type="button" id="shareBtn" class="ghost">Share invite</button>
          <button type="button" id="downloadBtn" class="ghost">Download responses</button>
        </div>

        <p id="confirmation" class="meta" style="display:none"></p>
      </form>
    </section>

    <aside class="card">
      <h3 style="margin-top:0"> List o' guests</h3>
      <div class="rsvp-list" id="rsvpList">
        <p class="meta">Guests</p>
      </div>

      <div style="margin-top:12px" class="footer">
        <button id="printBtn" class="ghost">Print invite</button>
      </div>

      <small class="meta" style="display:block;margin-top:12px"> No hoysting any other pirate's flag in my quarters this time please üôè</small>
    </aside>
  </main>

  <script>
    const form = document.getElementById('rsvpForm');
    const rsvpList = document.getElementById('rsvpList');
    const confirmation = document.getElementById('confirmation');
    const downloadBtn = document.getElementById('downloadBtn');
    const shareBtn = document.getElementById('shareBtn');
    const printBtn = document.getElementById('printBtn');
    const closePopup = document.getElementById('closePopup');
    const imagePopup = document.getElementById('imagePopup');
    const partyMusic = document.getElementById('partyMusic');

    closePopup.addEventListener('click', () => {
      imagePopup.style.display = 'none';
      partyMusic.play(); // Start music after user clicks
    });

    function loadResponses(){
      const raw = localStorage.getItem('rsvpResponses');
      return raw ? JSON.parse(raw) : [];
    }
    function saveResponses(list){
      localStorage.setItem('rsvpResponses', JSON.stringify(list));
    }

    function renderList(){
      const list = loadResponses();
      if(!list.length){
        rsvpList.innerHTML = '<p class="meta">No RSVPs yet ‚Äî yours could be first!</p>';
        return;
      }
      rsvpList.innerHTML = list.map(entry => `
        <div style="padding:8px;border-bottom:1px solid rgba(0,0,0,0.03)">
          <strong>${escapeHtml(entry.name)}</strong> ‚Ä¢ <span class="meta">${escapeHtml(entry.attend)}</span>
          <div class="meta">Guests: ${entry.guests || 0} ‚Ä¢ ${escapeHtml(entry.diet)}</div>
          <div style="margin-top:6px">${escapeHtml(entry.message)}</div>
        </div>
      `).join('');
    }

    function escapeHtml(s){
      if(!s) return '';
      return String(s).replace(/[&<>"']/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;','\'':'&#39;'}[ch]));
    }

    form.addEventListener('submit', e=>{
      e.preventDefault();
      const name = document.getElementById('name').value.trim() || 'Anonymous';
      const email = document.getElementById('email').value.trim();
      const attend = document.querySelector('input[name="attend"]:checked').value;
      const guests = document.getElementById('guests') ? document.getElementById('guests').value : 0;
      const diet = document.getElementById('diet') ? document.getElementById('diet').value : '';
      const message = document.getElementById('message').value.trim();

      const entry = {name, email, attend, guests: Number(guests), diet, message, timestamp: new Date().toISOString()};
      const list = loadResponses();
      list.unshift(entry);
      saveResponses(list);
      renderList();

      confirmation.style.display = 'block';
      confirmation.textContent = ` Many a thanks pirate ${name}! Yer RSVP has been archived.`;
      form.reset();

      setTimeout(()=> confirmation.style.display = 'none', 5000);
    });

    downloadBtn.addEventListener('click', ()=>{
      const list = loadResponses();
      const blob = new Blob([JSON.stringify(list, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'rsvp-responses.json';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });

    shareBtn.addEventListener('click', async ()=>{
      const title = document.title;
      const url = location.href;
      if(navigator.share){
        try{ await navigator.share({title, text:'Join mi birthday party!', url}); }
        catch(e){ alert('Share cancelled'); }
      } else {
        try{ await navigator.clipboard.writeText(url); alert('Link copied to clipboard!'); }
        catch(e){ prompt('Copy this link:', url); }
      }
    });

    printBtn.addEventListener('click', ()=> window.print());

    renderList();
  </script>

</body>
</html>
